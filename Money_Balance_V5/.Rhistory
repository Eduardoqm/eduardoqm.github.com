scale_color_manual(values=bank_pal)
gg1
gg1 = ggplot(bank2, aes(x=Date, y = bank))+
geom_line(aes(group = grp),size = 2)+
geom_point(size = 2)+
theme_minimal()+
labs(y = NULL, x = NULL, title ="Total Money in bank")+
#annotate(geom="text", x=bank2$Date[length(bank2$Date)-1],
#                                   y=max(bank2$Value)+1000,
#        label= round(bank2$Value[length(bank2$Value)], 0),
#          color = "darkblue", size = 5)+
ylim(min(bank2$Value), max(bank2$Value)+2000)+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90))+
scale_color_manual(values=bank_pal)
gg1
gg1 = ggplot(bank2, aes(x=Date, y = bank))+
geom_line(aes(group = grp),size = 2)+
geom_point(size = 2)+
theme_minimal()+
labs(y = NULL, x = NULL, title ="Total Money in bank")+
#annotate(geom="text", x=bank2$Date[length(bank2$Date)-1],
#                                   y=max(bank2$Value)+1000,
#        label= round(bank2$Value[length(bank2$Value)], 0),
#          color = "darkblue", size = 5)+
ylim(min(bank2$bank), max(bank2$bank)+2000)+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90))+
scale_color_manual(values=bank_pal)
gg1
#--------------------------------------------------------------------------------------
gg2 = ggplot(bank, aes(x=Date, y = Value, col = Bank))+
geom_line(aes(group = Bank), size = 2, alpha = 0.5)+
geom_point(size = 2)+
#facet_grid(rows = vars(Bank), scales = "free")+
theme_bw()+
labs(y = NULL, x = NULL, title ="Money by Bank")+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")+
scale_color_manual(values=bank_pal)
gg2
gg3 = ggplot(df, aes(x=Date, y = all, col = "darkred"))+
geom_line(aes(group = grp), size = 2, alpha = 0.5)+
geom_point(size = 2)+
theme_bw()+
labs(y = NULL, x = NULL, title = "Total Money with valued stuff")+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")+
scale_color_manual(values=money_pal)
gg3 = ggplot(df, aes(x=Date, y = all, col = "darkred"))+
geom_line(aes(group = grp), size = 2, alpha = 0.5)+
geom_point(size = 2)+
theme_bw()+
labs(y = NULL, x = NULL, title = "Total Money with valued stuff")+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
gg3
gg3 = ggplot(df, aes(x=Date, y = all, col = "darkred"))+
geom_line(aes(group = grp), size = 2, alpha = 0.8)+
geom_point(size = 2)+
theme_bw()+
labs(y = NULL, x = NULL, title = "Total Money with valued stuff")+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
gg3
gg3 = ggplot(df, aes(x=Date, y = all, col = "darkred"))+
geom_line(aes(group = grp), size = 2)+
geom_point(size = 2)+
theme_bw()+
labs(y = NULL, x = NULL, title = "Total Money with valued stuff")+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
gg3
ggplot(df, aes(x=Date, y=Valued_stuff))+
geom_col(fill = "blue", alpha = 0.55)+
theme_bw()+
ggtitle("Valued Stuff")+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90))
ggplot(df, aes(x=Date, y=Valued_stuff))+
geom_col(fill = "blue", alpha = 0.55)+
theme_bw()+
ggtitle("Valued Stuff")+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90))
#Gain and loss balance ====================================================================
#Gain in relation of initial data of my balance
strg = bank2
strg$balance_str_date = strg$Value - strg$Value[1]
strg$balance_str_date = strg$bank - strg$bank[1]
strg2 = df
strg2$balance_str_date = strg2$Total_Reais - strg2$Total_Reais[1]
strg2$balance_str_date = strg2$bank - strg2$bank[1]
ggplot(strg, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
theme_minimal()+
ggtitle("Gain in relation of initial money in bank")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.5,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg$balance_str_date)-2000, max(strg$balance_str_date)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain and loss balance ====================================================================
#Gain in relation of initial data of my balance
strg = bank2
strg$balance_str_date = strg$bank - strg$bank[1]
strg2 = df
strg2$balance_str_date = strg2$bank - strg2$bank[1]
ggplot(strg, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
theme_minimal()+
ggtitle("Gain in relation of initial money in bank")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.5,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg$balance_str_date)-2000, max(strg$balance_str_date)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(strg2, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
geom_line(aes(group = grp), size = 1, alpha = 0.7)+
geom_point(size = 1)+
theme_minimal()+
ggtitle("Gain in relation of initial money total")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.6,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg2$balance_str_date)-2000, max(strg2$balance_str_date)+2000)+
scale_fill_manual(values=c("red","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain in relation of previous month in bank money
bank_bal = bank2
bank_bal$bal = 0
zet = length(bank_bal$bal)
for (x in 1:zet) {
bank_bal$bal[x+1] = bank_bal$Value[x+1] - bank_bal$Value[x]
}
ggplot(bank_bal, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Money in Bank)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal$bal)-2000, max(bank_bal$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain in relation of previous month in total money
strg2 = df
strg2$balance_str_date = strg2$Total_Reais - strg2$Total_Reais[1]
bank_bal2 = df
bank_bal2$bal = 0
zet = length(bank_bal2$bal)
for (x in 1:zet) {
bank_bal2$bal[x+1] = bank_bal2$Total_Reais[x+1] - bank_bal2$Total_Reais[x]
}
ggplot(bank_bal2, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Total Money)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal2$bal)-2000, max(bank_bal2$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain and loss balance ====================================================================
#Gain in relation of initial data of my balance
strg = bank2
strg$balance_str_date = strg$bank - strg$bank[1]
strg2 = df
strg2$balance_str_date = strg2$bank - strg2$bank[1]
ggplot(strg, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
theme_minimal()+
ggtitle("Gain in relation of initial money in bank")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.5,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg$balance_str_date)-2000, max(strg$balance_str_date)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain in relation of previous month in bank money
bank_bal = bank2
bank_bal$bal = 0
zet = length(bank_bal$bal)
for (x in 1:zet) {
bank_bal$bal[x+1] = bank_bal$Value[x+1] - bank_bal$Value[x]
}
ggplot(bank_bal, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Money in Bank)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal$bal)-2000, max(bank_bal$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain in relation of previous month in total money
strg2 = df
strg2$balance_str_date = strg2$Total_Reais - strg2$Total_Reais[1]
bank_bal2 = df
bank_bal2$bal = 0
zet = length(bank_bal2$bal)
for (x in 1:zet) {
bank_bal2$bal[x+1] = bank_bal2$Total_Reais[x+1] - bank_bal2$Total_Reais[x]
}
ggplot(bank_bal2, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Total Money)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal2$bal)-2000, max(bank_bal2$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(strg, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
theme_minimal()+
ggtitle("Gain in relation of initial money in bank")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.5,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg$balance_str_date)-2000, max(strg$balance_str_date)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(bank_bal, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Money in Bank)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal$bal)-2000, max(bank_bal$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(bank_bal, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Money in Bank)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal$bal)-2000, max(bank_bal$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(strg2, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
geom_line(aes(group = grp), size = 1, alpha = 0.7)+
geom_point(size = 1)+
theme_minimal()+
ggtitle("Gain in relation of initial money total")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.6,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg2$balance_str_date)-2000, max(strg2$balance_str_date)+2000)+
scale_fill_manual(values=c("red","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(strg, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
theme_minimal()+
ggtitle("Gain in relation of initial money in bank")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.5,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg$balance_str_date)-2000, max(strg$balance_str_date)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain in relation of previous month in bank money
bank_bal = bank2
bank_bal$bal = 0
zet = length(bank_bal$bal)
for (x in 1:zet) {
bank_bal$bal[x+1] = bank_bal$bank[x+1] - bank_bal$bank[x]
}
ggplot(bank_bal, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Money in Bank)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal$bal)-2000, max(bank_bal$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain and loss balance ====================================================================
#Gain in relation of initial data of my balance
strg = bank2
strg$balance_str_date = strg$bank - strg$bank[1]
strg2 = df
strg2$balance_str_date = strg2$all - strg2$all[1]
ggplot(strg, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
theme_minimal()+
ggtitle("Gain in relation of initial money in bank")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.5,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg$balance_str_date)-2000, max(strg$balance_str_date)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(strg2, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
geom_line(aes(group = grp), size = 1, alpha = 0.7)+
geom_point(size = 1)+
theme_minimal()+
ggtitle("Gain in relation of initial money total")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.6,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg2$balance_str_date)-2000, max(strg2$balance_str_date)+2000)+
scale_fill_manual(values=c("red","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain in relation of previous month in bank money
bank_bal = bank2
bank_bal$bal = 0
zet = length(bank_bal$bal)
for (x in 1:zet) {
bank_bal$bal[x+1] = bank_bal$Value[x+1] - bank_bal$Value[x]
}
ggplot(bank_bal, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Money in Bank)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal$bal)-2000, max(bank_bal$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain in relation of previous month in total money
strg2 = df
strg2$balance_str_date = strg2$all - strg2$all[1]
bank_bal2 = df
bank_bal2$bal = 0
zet = length(bank_bal2$bal)
for (x in 1:zet) {
bank_bal2$bal[x+1] = bank_bal2$all[x+1] - bank_bal2$all[x]
}
ggplot(bank_bal2, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Total Money)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal2$bal)-2000, max(bank_bal2$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain and loss balance ====================================================================
#Gain in relation of initial data of my balance
strg = bank2
strg$balance_str_date = strg$bank - strg$bank[1]
strg2 = df
strg2$balance_str_date = strg2$all - strg2$all[1]
ggplot(strg, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
theme_minimal()+
ggtitle("Gain in relation of initial money in bank")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.5,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg$balance_str_date)-2000, max(strg$balance_str_date)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(strg2, aes(x=Date, y = balance_str_date, fill=factor(sign(balance_str_date))))+
geom_col()+
geom_line(aes(group = grp), size = 1, alpha = 0.7)+
geom_point(size = 1)+
theme_minimal()+
ggtitle("Gain in relation of initial money total")+
labs(y = "Difference in relation initial money (Reais)", x = NULL)+
geom_text(aes(label = round(balance_str_date, 0),
hjust = 0.6,
vjust = ifelse(balance_str_date < 0, 1.5, -1)), size = 2.5) +
ylim(min(strg2$balance_str_date)-2000, max(strg2$balance_str_date)+2000)+
scale_fill_manual(values=c("red","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain in relation of previous month in bank money
bank_bal = bank2
bank_bal$bal = 0
zet = length(bank_bal$bal)
for (x in 1:zet) {
bank_bal$bal[x+1] = bank_bal$bank[x+1] - bank_bal$bank[x]
}
ggplot(bank_bal, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Money in Bank)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal$bal)-2000, max(bank_bal$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
#Gain in relation of previous month in total money
strg2 = df
strg2$balance_str_date = strg2$all - strg2$all[1]
bank_bal2 = df
bank_bal2$bal = 0
zet = length(bank_bal2$bal)
for (x in 1:zet) {
bank_bal2$bal[x+1] = bank_bal2$all[x+1] - bank_bal2$all[x]
}
ggplot(bank_bal2, aes(x=Date, y = bal, fill=factor(sign(bal))))+
geom_col()+
theme_minimal()+
ggtitle("Monthly Gain and Loss Balance (Total Money)")+
labs(y = "Gain and Loss (Reais)", x = NULL)+
geom_text(aes(label = round(bal, 0),
hjust = 0.5,
vjust = ifelse(bal < 0, 1.5, -1)), size = 2.5) +
ylim(min(bank_bal2$bal)-2000, max(bank_bal2$bal)+2000)+
scale_fill_manual(values=c("red","blue","darkgreen"))+
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 90), legend.position = "none")
View(df)
#-------------------------------------------------------------------------------
#Pizza percentage graph
perc = df[,c(4,5,7)]
head(perc)
#-------------------------------------------------------------------------------
#Pizza percentage graph
perc = df[,c(4:7)]
head(perc)
perc$Real_bank = perc$bank
perc$total = perc$all
head(perc)
perc2 = perc
perc2$Real_bank = signif((perc$Real_bank/perc$total)*100, digits = 2)
perc2$Valued_stuff = signif((perc$Valued_stuff/perc$total)*100, digits = 2)
head(perc2)
perc2 = perc2[,c(1,4,5)]
head(perc2)
perc2 = tail(perc2, n =1)
head(perc2)
perc2 = melt(perc2)
head(perc2)
head(perc)
perc = perc[,c(1,4,5)]
perc = tail(perc, n =1)
perc = melt(perc)
perc$value = signif(perc$value, digits = 2)/1000
head(perc)
ggplot(perc2, aes(x=value, y=variable, fill = variable))+
geom_col()+
geom_text(aes(x = value, label = paste0(value, "% (", perc$value, " mil R$)")), color = "black", size=4, hjust = -0.1) +
scale_fill_manual(values = c("darkred","darkgreen","RoyalBlue","orange"))+
labs(y = NULL, x = NULL, title = "Proportion of money")+
theme_bw()+
xlim(0, max(perc2$value + 20))+
theme(legend.position = "None")
ggplot(perc2, aes(x=value, y=variable, fill = variable))+
geom_col()+
geom_text(aes(x = value, label = paste0(value, "% (", perc$value, " mil R$)")), color = "black", size=4, hjust = -0.1) +
scale_fill_manual(values = c("darkred","darkgreen"))+
labs(y = NULL, x = NULL, title = "Proportion of money")+
theme_bw()+
xlim(0, max(perc2$value + 20))+
theme(legend.position = "None")
ggplot(perc2, aes(x=value, y=variable, fill = variable))+
geom_col()+
geom_text(aes(x = value, label = paste0(value, "% (", perc$value, " mil R$)")), color = "black", size=4, hjust = -0.1) +
scale_fill_manual(values = c("darkblue","darkred"))+
labs(y = NULL, x = NULL, title = "Proportion of money")+
theme_bw()+
xlim(0, max(perc2$value + 20))+
theme(legend.position = "None")
